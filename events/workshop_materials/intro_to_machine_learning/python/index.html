<!-- Elements added to main will be displayed on all pages -->

<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="../../../../assets/images/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.26">
    
    
      
        <title>Index - UArizona HPC Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.6543a935.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      

  
  
  
  
  <style>:root{--md-annotation-icon:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.17 2.76A10.1 10.1 0 0 1 12 2c1.31 0 2.61.26 3.83.76 1.21.5 2.31 1.24 3.24 2.17.93.93 1.67 2.03 2.17 3.24.5 1.22.76 2.52.76 3.83 0 2.65-1.05 5.2-2.93 7.07A9.974 9.974 0 0 1 12 22a10.1 10.1 0 0 1-3.83-.76 9.975 9.975 0 0 1-3.24-2.17A9.974 9.974 0 0 1 2 12c0-2.65 1.05-5.2 2.93-7.07.93-.93 2.03-1.67 3.24-2.17M12 17l1.56-3.42L17 12l-3.44-1.56L12 7l-1.57 3.44L7 12l3.43 1.58L12 17Z"/></svg>');}</style>


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-3V0VRBSRZF"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-3V0VRBSRZF",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-3V0VRBSRZF",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#intro-to-machine-learning-with-python-on-hpc" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
            
 <p style="font-size: 15px;"><b>New Documentation</b><br>Welcome to our new HPC documentation website! Have comments or suggestions on improving the content? <a href="../support_and_training/consulting_services/">Contact us</a> to let us know your thoughts.</p>

          </div>
          
        </aside>
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="UArizona HPC Documentation" class="md-header__button md-logo" aria-label="UArizona HPC Documentation" data-md-component="logo">
      
  <img src="../../../../assets/images/home/uofa_cactus_computing3.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            UArizona HPC Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Index
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/UA-ResearchComputing-HPC/hpc-documentation" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="UArizona HPC Documentation" class="md-nav__button md-logo" aria-label="UArizona HPC Documentation" data-md-component="logo">
      
  <img src="../../../../assets/images/home/uofa_cactus_computing3.png" alt="logo">

    </a>
    UArizona HPC Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/UA-ResearchComputing-HPC/hpc-documentation" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    HPC Quick Start
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            HPC Quick Start
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../quick_start/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../quick_start/what_is_hpc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    What is HPC?
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../quick_start/common_misconceptions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Common Misconceptions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../quick_start/logging_in/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logging In
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../quick_start/storage_and_transfers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Storage and Transfers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../quick_start/accessing_compute/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Accessing Compute Nodes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../quick_start/software/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Software
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../quick_start/summary/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Summary
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Policies
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Policies
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../policies/acceptable_use/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Acceptable Use
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../policies/acknowledgements/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Acknowledgements
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../policies/buy_in/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Buy-in
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../policies/committees/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Committees
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../policies/loss_of_university_affiliation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Loss of University Affiliation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../policies/maintenance/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Maintenance
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../policies/special_projects/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Special Projects
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Resources
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Resources
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../resources/allocations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Allocations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../resources/compute_resources/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Compute Resources
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../resources/data_center/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Research Data Center
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../resources/secure_hpc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Secure Services
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Access
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Access
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../registration_and_access/account_creation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Account Creation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../registration_and_access/account_deletion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Account Deletion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../registration_and_access/group_management/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Group Management
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../registration_and_access/system_access/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    System Access
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../registration_and_access/system_overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    System Layout
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../registration_and_access/vpn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VPN
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Storage and Transfers
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Storage and Transfers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1" >
        
          
          <label class="md-nav__link" for="__nav_6_1" id="__nav_6_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Storage
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1">
            <span class="md-nav__icon md-icon"></span>
            Storage
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../storage_and_transfers/storage/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../storage_and_transfers/storage/hpc_storage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HPC Storage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../storage_and_transfers/storage/rental_storage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rental Storage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../storage_and_transfers/storage/rdas_storage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    R-DAS Storage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../storage_and_transfers/storage/tier2_storage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tier2 AWS Storage
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2" >
        
          
          <label class="md-nav__link" for="__nav_6_2" id="__nav_6_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Transfers
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2">
            <span class="md-nav__icon md-icon"></span>
            Transfers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../storage_and_transfers/transfers/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../storage_and_transfers/transfers/open_on_demand/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Open OnDemand
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../storage_and_transfers/transfers/cyberduck/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cyberduck
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../storage_and_transfers/transfers/sftp_ftp_lftp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FTP/LFTP/SFTP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../storage_and_transfers/transfers/globus/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Globus
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../storage_and_transfers/transfers/irods/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    iRODS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../storage_and_transfers/transfers/rsync/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rsync
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../storage_and_transfers/transfers/rclone/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rclone
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../storage_and_transfers/transfers/scp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SCP
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Software
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Software
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../software/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../software/modules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modules
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../software/user_installations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    User Installations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../software/common_datasets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Common Datasets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_5" >
        
          
          <label class="md-nav__link" for="__nav_7_5" id="__nav_7_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Popular Software
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_5">
            <span class="md-nav__icon md-icon"></span>
            Popular Software
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../software/popular_software/anaconda/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Anaconda
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../software/popular_software/gaussian/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Gaussian
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../software/popular_software/matlab/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Matlab
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../software/popular_software/perl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Perl
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../software/popular_software/python/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../software/popular_software/R/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    R
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../software/popular_software/vscode_remote_connection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VSCode Remote Connection
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_6" >
        
          
          <label class="md-nav__link" for="__nav_7_6" id="__nav_7_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Containers
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_6">
            <span class="md-nav__icon md-icon"></span>
            Containers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../software/containers/what_are_containers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    What are Containers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../software/containers/containers_on_hpc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Containers on HPC
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../software/containers/pulling_containers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pulling Containers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../software/containers/building_containers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Building Containers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../software/containers/using_containers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using Containers
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Running Jobs
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Running Jobs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../running_jobs/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../running_jobs/job_limits/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Job Limits
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../running_jobs/cpus_and_memory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CPUs and Memory
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../running_jobs/open_on_demand/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Open OnDemand/Graphical Jobs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../running_jobs/interactive_jobs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Interactive Jobs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_6" >
        
          
          <label class="md-nav__link" for="__nav_8_6" id="__nav_8_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Batch Jobs
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_6">
            <span class="md-nav__icon md-icon"></span>
            Batch Jobs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../running_jobs/batch_jobs/intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intro to Batch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../running_jobs/batch_jobs/batch_directives/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Batch Directives
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../running_jobs/batch_jobs/environment_variables/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Environment Variables
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../running_jobs/batch_jobs/array_jobs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Array Jobs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../running_jobs/batch_jobs/submitting_jobs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Submitting Jobs
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../running_jobs/monitoring_jobs_and_resources/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Monitoring Jobs and Resources
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../running_jobs/parallelization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parallelization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_9" >
        
          
          <label class="md-nav__link" for="__nav_8_9" id="__nav_8_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Visualization
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_9">
            <span class="md-nav__icon md-icon"></span>
            Visualization
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../running_jobs/visualization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intro
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_9_2" >
        
          
          <label class="md-nav__link" for="__nav_8_9_2" id="__nav_8_9_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Blender
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_9_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_9_2">
            <span class="md-nav__icon md-icon"></span>
            Blender
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../running_jobs/visualization/blender/command_line_rendering/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Blender Command Line Rendering
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../running_jobs/visualization/blender/scaling_up_blender_rendering/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Scaling Up Blender Rendering
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_9_3" >
        
          
          <label class="md-nav__link" for="__nav_8_9_3" id="__nav_8_9_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Paraview
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_9_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_9_3">
            <span class="md-nav__icon md-icon"></span>
            Paraview
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../running_jobs/visualization/Paraview/Essential%20Ideas%20for%20ParaView/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Essential Ideas
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../running_jobs/visualization/Paraview/Getting%20Started%20With%20ParaView/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../running_jobs/visualization/Paraview/Advanced%20Computational%20Geometry%20in%20Paraview%20with%20CGAL%20%26%20Vespa/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CGAl Vespa
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../running_jobs/visualization/Paraview/Demystifying%20Paraview%20Python%20Plugins%20%28or%20at%20least%20a%20little%20less%20mystery%29/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Paraview Python Plugins
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../running_jobs/visualization/Paraview/Getting%20Started%20With%20The%20Paraview%20Terminal%20%28PvPython%29/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started with Paraview Terminal
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../running_jobs/visualization/Paraview/Graphs%20and%20Exporting%20Data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Graphs and Exporting Data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../running_jobs/visualization/Paraview/ParaView%20Cameras%20and%20Keyframes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cameras and Keyframes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../running_jobs/visualization/Paraview/Paraview%20Headless%20Batch%20Rendering/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Headless Batch Rendering
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../running_jobs/visualization/Paraview/Speeding%20up%20Filters%20%26%20Rendering%20with%20Client%20Server%20configurations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Speeding up Filters & Rendering with Client Server configurations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../running_jobs/visualization/Paraview/Visualizing%20NetCDF%20Files/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Visualizing NetCDF Files
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../running_jobs/visualization/Paraview/paratestimages/index.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Paratest images
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../running_jobs/visualization/creating_heightmaps_arcgis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Arcgis Pro Heightmaps
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../running_jobs/visualization/VisIt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VisIt
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Support
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Support
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../support_and_training/consulting_services/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Consulting Services
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../support_and_training/people/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Support Staff
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../support_and_training/faqs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FAQs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../support_and_training/glossary/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Glossary
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../support_and_training/cheat_sheet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linux Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../support_and_training/grants/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Grants
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../support_and_training/external_resources/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Community and External Resources
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../support_and_training/website_accessibility/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Website Accessibility
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Events and Workshops
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Events and Workshops
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../calendar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Calendar
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HPC Workshop Materials
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../results/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Results
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<p><link rel="stylesheet" href="../../../../assets/stylesheets/embedded_files.css">
<link rel="stylesheet" href="../../../../assets/stylesheets/buttons.css"></p>
<h1 id="intro-to-machine-learning-with-python-on-hpc">Intro to Machine Learning with Python on HPC</h1>
<p>We will discuss a few hands-on examples of machine learning with Python. You can run these in a Jupyter notebook, or using a batch script (see <a href="../../intro-to-hpc/index.md">Intro to HPC</a>). Here we emphasize on using Jupyter notebooks. We recommend that you try these hands-on examples.</p>
<h2 id="why-use-python-for-machine-learning">Why use Python for machine learning?</h2>
<ul>
<li>Python is probably the most popular language for machine learning</li>
<li>Python has a large ecosystem of packages for everything machine learning</li>
<li>All popular machine learning platforms provide Python APIs</li>
<li>All HPC consultants are very familiar with Python</li>
</ul>
<h2 id="things-to-look-out-for">Things to look out for</h2>
<p>The popularity of Python also means that there are a lot of moving pieces. Sometimes, that can complicate your workflow. For machine learning with Python on HPC, keep the following in mind:</p>
<ul>
<li>Don't mix Python versions</li>
<li>Using GPUs might need some extra configuration</li>
<li>Not all Python package managers play well with HPC environments</li>
</ul>
<h2 id="setting-up-python-for-machine-learning-on-hpc">Setting up Python for machine learning on HPC</h2>
<p><mark class="critic">Use virtual environments to install Python packages.</mark> See <a href="../../../../software/popular_software/python/">Python</a> to learn how to create virtual environments with built-in Python tools. See <a href="../../../../software/popular_software/anaconda/">Anaconda</a> to learn how to create virtual environments with Conda (or its variants).</p>
<p>For the hands-on examples we will need the following packages (with GPU support):</p>
<ul>
<li><code>torch</code> - base PyTorch, think of this as an accelerated version of NumPy</li>
<li><code>torchvision</code> - adds support for machine learning with images to PyTorch</li>
<li><code>fastai</code> - layer on top of PyTorch that makes training easier</li>
</ul>
<p>We will install these in a Python (version 3.8) virtual environment, and then create a Jupyter kernel so that we can access them from a Jupyter notebook. Installing <code>fastai</code> will install various other packages, like <code>pandas</code> and <code>matplotlib</code>, which we will also use. But we do not need to install them separately.</p>
<p class="annotate">To create a Python virtual environment you need to be in an <a href="../../../../running_jobs/interactive_jobs/">interactive session</a>. Once in an interactive session run the following commands (1)</p>
<ol>
<li>
<p>Choose suitable values for </p>
<ul>
<li><code>&lt;path-to-venv&gt;</code>: location where you want to install your Python virtual environment</li>
<li><code>&lt;kernel-name&gt;</code>: name of the Jupyter kernel, e.g. <code>ml-workshop</code></li>
<li><code>&lt;optional-display-name&gt;</code>: optional prettier name for the Jupyter kernel shown in the Jupyter dashboard, e.g. <code>Python (ML Workshop)</code></li>
</ul>
</li>
</ol>
<div class="highlight"><pre><span></span><code>module<span class="w"> </span>load<span class="w"> </span>python/3.8
module<span class="w"> </span>load<span class="w"> </span>cuda11<span class="w"> </span>cuda11-dnn<span class="w"> </span>cuda11-sdk<span class="w"> </span><span class="c1"># (1)!</span>
python3<span class="w"> </span>-m<span class="w"> </span>venv<span class="w"> </span>--system-site-packages<span class="w"> </span>&lt;path-to-venv&gt;
<span class="nb">source</span><span class="w"> </span>&lt;path-to-venv&gt;/bin/activate
pip3<span class="w"> </span>install<span class="w"> </span>torch<span class="w"> </span>torchvision<span class="w"> </span>torchaudio<span class="w"> </span>--index-url<span class="w"> </span>https://download.pytorch.org/whl/cu118
pip3<span class="w"> </span>install<span class="w"> </span>fastai
pip3<span class="w"> </span>install<span class="w"> </span>jupyter<span class="w"> </span>--force-reinstall
ipython<span class="w"> </span>kernel<span class="w"> </span>install<span class="w"> </span>--name<span class="w"> </span>&lt;kernel-name&gt;<span class="w"> </span>--user<span class="w"> </span>--display-name<span class="w"> </span>&lt;optional-display-name&gt;
</code></pre></div>
<ol>
<li>Load these modules for GPU support.</li>
</ol>
<h2 id="jupyter-notebooks-on-uarizona-hpc">Jupyter Notebooks on UArizona HPC</h2>
<p>UArizona HPC provides access to Jupyter notebooks via <a href="../../../../running_jobs/open_on_demand">Open OnDemand</a> (OOD). The following steps show how you can launch a Jupyter notebook from UArizona HPC's OOD portal:</p>
<div class="annotate">
<ol>
<li>Navigate to <a href="https://ood.hpc.arizona.edu/">https://ood.hpc.arizona.edu/</a>. After login, you will see the OOD dashboard.
<img src="images/ood_dashboard.png" alt="OOD Dashboard" height="400"/></li>
<li>Select <strong>Interactive Apps</strong>, and then from the drop-down menu select <strong>Jupyter Notebook</strong>.
<img src="images/ood_dropdown.png" alt="OOD Dashboard" height="400"/></li>
<li>Fill in the details in the form that opens up (1), and select <strong>Launch</strong>.
<img src="images/ood_jupyter_form.png" alt="OOD Dashboard" height="400"/></li>
<li>After the session becomes available, select <strong>Connect to Jupyter</strong> (2).
<img src="images/ood_jupyter_running.png" alt="Running" width="800"/></li>
<li>Once you are in the Jupyter dashboard, create a notebook with the kernel you had installed.
<img src="images/ood_jupyter_start_kernel.png" alt="Choose kernel" width="800"/></li>
</ol>
</div>
<ol>
<li>Use your PI's group's name for the <em>PI Group</em> field. You can find out your PI's group's name by running <code>va</code> in a terminal session.</li>
<li>After you select <strong>Launch</strong> in the previous step, OOD will take you to a page with a tile that shows your pending job. When it's first submitted, its status will show as <strong>Queued</strong>. Once it starts, it's status will change to <strong>Running</strong> and you'll see the <strong>Connect to Jupyter</strong> link. </li>
</ol>
<h2 id="examples">Examples</h2>
<h3 id="classification"> Classification</h3>
<p><center><a class="md-button" href="files/fungi-classification.ipynb">Click here to download Jupyter notebook</a></center></p>
<p>In this example we will identify fungi species by their images. We will use a subset of the <a href="https://sites.google.com/view/danish-fungi-dataset/home">Danish Fungi 2020</a> dataset.</p>
<p><img src="images/df20-sample.png" alt="Danish Fungi 2020 sample", width="600"/></p>
<h4 id="accessing-the-data">Accessing the data</h4>
<p class="annotate">The local dataset is at <code>/contrib/datasets/workshops/DF20M-4.tar.gz</code>. You can access from an interactive session. It consists of the four species with the most images in the DF20-Mini dataset. Copy it to your working directory (1), and untar it.</p>
<ol>
<li>under your home directory, or your PI's <code>/groups</code> or <code>/xdisk</code> share</li>
</ol>
<p>From an interactive session, run the following:
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>&lt;working-dir&gt;
cp<span class="w"> </span>/contrib/datasets/workshops/DF20M-4.tar.gz<span class="w"> </span>./
tar<span class="w"> </span>xvf<span class="w"> </span>DF20M-4.tar.gz
</code></pre></div></p>
<h4 id="visualize-the-data">Visualize the data</h4>
<p>A sample of the local dataset will look different from the image above because it only contains a subset of the species. Visualizing the data will help us to decide which model to use, and how to train it. </p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">path</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">islice</span>

<span class="k">def</span> <span class="nf">_ls</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span> <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">islice</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">iterdir</span><span class="p">(),</span> <span class="n">n</span><span class="p">))</span> <span class="c1"># (1)!</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;/xdisk/sohampal/sohampal/fungi/DF20M-4/&quot;</span><span class="p">)</span> <span class="c1"># (2)!</span>
<span class="n">_ls</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</code></pre></div>
<ol>
<li>Helper function to list the contents of a directory. Why do we need <code>n</code>?</li>
<li>Replace this with the path to where you downloaded the data.</li>
</ol>
<div class="highlight"><pre><span></span><code>[PosixPath(&#39;/xdisk/sohampal/sohampal/fungi/DF20M-4/train&#39;),
 PosixPath(&#39;/xdisk/sohampal/sohampal/fungi/DF20M-4/DF20M-4.tar&#39;),
 PosixPath(&#39;/xdisk/sohampal/sohampal/fungi/DF20M-4/test&#39;)]
</code></pre></div>
<p>There are two directories in the dataset, <code>train</code> and <code>test</code>: </p>
<ul>
<li><code>train</code> contains images for training your model</li>
<li><code>test</code> contains images for testing how well your model has learned</li>
</ul>
<p>We can use <code>_ls()</code> to probe the contents of <code>train</code>, <code>test</code>, and their subdirectories.</p>
<div class="highlight"><pre><span></span><code><span class="n">_ls</span><span class="p">(</span><span class="n">p</span> <span class="o">/</span> <span class="s2">&quot;train&quot;</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>[PosixPath(&#39;/xdisk/sohampal/sohampal/fungi/DF20M-4/train/Mycena galericulata&#39;),
 PosixPath(&#39;/xdisk/sohampal/sohampal/fungi/DF20M-4/train/Boletus edulis&#39;),
 PosixPath(&#39;/xdisk/sohampal/sohampal/fungi/DF20M-4/train/Amanita muscaria&#39;),
 PosixPath(&#39;/xdisk/sohampal/sohampal/fungi/DF20M-4/train/Clitocybe nebularis&#39;)]
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">_ls</span><span class="p">(</span><span class="n">p</span> <span class="o">/</span> <span class="s2">&quot;test&quot;</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>[PosixPath(&#39;/xdisk/sohampal/sohampal/fungi/DF20M-4/test/Mycena galericulata&#39;),
 PosixPath(&#39;/xdisk/sohampal/sohampal/fungi/DF20M-4/test/Boletus edulis&#39;),
 PosixPath(&#39;/xdisk/sohampal/sohampal/fungi/DF20M-4/test/Amanita muscaria&#39;),
 PosixPath(&#39;/xdisk/sohampal/sohampal/fungi/DF20M-4/test/Clitocybe nebularis&#39;)]
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">_ls</span><span class="p">(</span><span class="n">p</span> <span class="o">/</span> <span class="s2">&quot;test&quot;</span> <span class="o">/</span> <span class="s2">&quot;Mycena galericulata&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="c1"># (1)!</span>
</code></pre></div>
<ol>
<li>Change the number to something else, and see what you get.</li>
</ol>
<div class="highlight"><pre><span></span><code>[PosixPath(&#39;/xdisk/sohampal/sohampal/fungi/DF20M-4/test/Mycena galericulata/2238582384-112591.JPG&#39;),
 PosixPath(&#39;/xdisk/sohampal/sohampal/fungi/DF20M-4/test/Mycena galericulata/2427873332-344961.JPG&#39;),
 PosixPath(&#39;/xdisk/sohampal/sohampal/fungi/DF20M-4/test/Mycena galericulata/2238559251-255760.JPG&#39;),
 PosixPath(&#39;/xdisk/sohampal/sohampal/fungi/DF20M-4/test/Mycena galericulata/2238471930-167014.JPG&#39;)]
</code></pre></div>
<p>The subdirectories of <code>train</code> and <code>test</code> tell us the name of the species. For example, all the training images corresponding to  <em>Boletus edulis</em> are grouped under the subdirectory <code>Boletus edulis</code>.</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span><span class="n">d</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">_ls</span><span class="p">(</span><span class="n">d</span><span class="p">))</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">_ls</span><span class="p">(</span><span class="n">p</span> <span class="o">/</span> <span class="s2">&quot;train&quot;</span><span class="p">)}</span> 
</code></pre></div>
<div class="highlight"><pre><span></span><code>{&#39;Mycena galericulata&#39;: 1099,
 &#39;Boletus edulis&#39;: 811,
 &#39;Amanita muscaria&#39;: 863,
 &#39;Clitocybe nebularis&#39;: 1003}
</code></pre></div>
<p>The dataset is fairly balanced:</p>
<ul>
<li><em>Mycena galericulata</em> and <em>Clitocybe nebularis</em> have similar number of training images</li>
<li><em>Boletus edulis</em> and <em>Amanita muscaria</em> have similar number of training images (around 80% of the other two)</li>
</ul>
<p>It is usually much easier to train models with balanced datasets. For unbalanced datasets you might have to adopt smarter training processes to counter the bias in the datasets.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>

<span class="k">def</span> <span class="nf">show_images</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">8</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">imgs</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">iterdir</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axes</span><span class="p">):</span>
        <span class="n">img</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">imgs</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">img</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">([])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">([])</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

<span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">_ls</span><span class="p">((</span><span class="n">p</span> <span class="o">/</span> <span class="s2">&quot;train&quot;</span><span class="p">)):</span> <span class="n">show_images</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</code></pre></div>
<p><img src="images/mycena_galericulata_sample.png" alt="Mycena galericulata sample", width="800"/></p>
<p><img src="images/boletus_edulis_sample.png" alt="Boletus edulis sample", width="800"/></p>
<p><img src="images/amanita_muscaria_sample.png" alt="Amanita muscaria sample", width="800"/></p>
<p><img src="images/clitocybe_nebularis_sample.png" alt="Clitocybe nebularis sample", width="800"/></p>
<p>The images are of different shapes, this will be important when you train a model. </p>
<h4 id="simpler-problem-binary-classification">Simpler problem: binary classification</h4>
<p>In the image samples above, we see that <em>Boletus edulis</em> and <em>Amanita muscaria</em> look drastically different from each other (they also have similar number of images). As a simpler problem, we will train a model to classify these two fungi species.</p>
<p>We will create a subdirectory called <code>binary</code> and copy the <code>train</code> and <code>test</code> images for the two species to it. This is not strictly necessary, but it will be easier to use the <code>fastai</code> dataloaders in this way.</p>
<p>You can copy the images using either <a href="../../../cheat_sheet/index.md">shell tools</a> from a terminal, or by running the following Python code from Jupyter.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">shutil</span>

<span class="k">def</span> <span class="nf">copy_images</span><span class="p">(</span><span class="n">partition</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">fungi</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;Boletus edulis&quot;</span><span class="p">,</span> <span class="s2">&quot;Amanita muscaria&quot;</span><span class="p">):</span>
        <span class="p">(</span><span class="n">p</span> <span class="o">/</span> <span class="s2">&quot;binary&quot;</span> <span class="o">/</span> <span class="n">partition</span> <span class="o">/</span> <span class="n">fungi</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <span class="p">(</span><span class="n">p</span> <span class="o">/</span> <span class="n">partition</span> <span class="o">/</span> <span class="n">fungi</span><span class="p">)</span><span class="o">.</span><span class="n">iterdir</span><span class="p">():</span>
            <span class="n">shutil</span><span class="o">.</span><span class="n">copy2</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">p</span> <span class="o">/</span> <span class="s2">&quot;binary&quot;</span> <span class="o">/</span> <span class="n">partition</span> <span class="o">/</span> <span class="n">fungi</span><span class="p">)</span>

<span class="n">copy_images</span><span class="p">(</span><span class="s2">&quot;train&quot;</span><span class="p">)</span>
<span class="n">copy_images</span><span class="p">(</span><span class="s2">&quot;test&quot;</span><span class="p">)</span>
</code></pre></div>
<p>Check that all the data has been copied correctly.</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span><span class="n">d</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">_ls</span><span class="p">(</span><span class="n">d</span><span class="p">))</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">_ls</span><span class="p">(</span><span class="n">p</span> <span class="o">/</span> <span class="s2">&quot;binary&quot;</span> <span class="o">/</span> <span class="s2">&quot;train&quot;</span><span class="p">)}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>{&#39;Boletus edulis&#39;: 811, &#39;Amanita muscaria&#39;: 863}
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="p">{</span><span class="n">d</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">_ls</span><span class="p">(</span><span class="n">d</span><span class="p">))</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">_ls</span><span class="p">(</span><span class="n">p</span> <span class="o">/</span> <span class="s2">&quot;binary&quot;</span> <span class="o">/</span> <span class="s2">&quot;test&quot;</span><span class="p">)}</span>
</code></pre></div>
<p><div class="highlight"><pre><span></span><code>{&#39;Boletus edulis&#39;: 90, &#39;Amanita muscaria&#39;: 96}
</code></pre></div>
The <code>fastai</code> package provides a <code>DataBlock</code> class to easily load the data to the model.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">fastai.data.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">fastai.vision.all</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">dblock</span> <span class="o">=</span> <span class="n">DataBlock</span><span class="p">(</span><span class="n">blocks</span> <span class="o">=</span> <span class="p">(</span><span class="n">ImageBlock</span><span class="p">,</span> <span class="n">CategoryBlock</span><span class="p">),</span>
                   <span class="n">get_items</span> <span class="o">=</span> <span class="n">get_image_files</span><span class="p">,</span>
                   <span class="n">get_y</span> <span class="o">=</span> <span class="n">parent_label</span><span class="p">,</span>
                   <span class="n">splitter</span> <span class="o">=</span> <span class="n">RandomSplitter</span><span class="p">(),</span>
                   <span class="n">item_tfms</span> <span class="o">=</span> <span class="n">Resize</span><span class="p">(</span><span class="mi">224</span><span class="p">))</span>
</code></pre></div>
<p>It is useful to understand the different arguments used when instantiating the <code>DataBlock</code> class:</p>
<ul>
<li><code>blocks = (ImageBlock, CategoryBlock)</code>: Every instance of data consists of an image and a corresponding category (species name)</li>
<li><code>get_items = get_image_files</code>: Uses the <code>get_image_files</code> function from <code>fastai</code> to load the image files</li>
<li><code>get_y = parent_label</code>: Uses the <code>parent_label</code> function from <code>fastai</code> to get the corresponding categories (in this case the name of the parent directory)</li>
<li><code>splitter = RandomSplitter()</code>: Randomly splits the data in to a train set and a validation set</li>
<li><code>item_tfms = Resize(224)</code>: Resizes all images to a size of 224 pixels x 224 pixels</li>
</ul>
<p><code>dblock</code>  does not actually know where the images are. We can create a <code>Datasets</code> object from <code>dblock</code> which knows where the images are. Think of it as applying <code>dblock</code> to each of the images under <code>binary/train</code>.</p>
<div class="highlight"><pre><span></span><code><span class="n">dsets</span> <span class="o">=</span> <span class="n">dblock</span><span class="o">.</span><span class="n">datasets</span><span class="p">(</span><span class="n">p</span> <span class="o">/</span> <span class="s2">&quot;binary&quot;</span> <span class="o">/</span> <span class="s2">&quot;train&quot;</span><span class="p">)</span>
</code></pre></div>
<p>By default, <code>RandomSplitter</code> does a 80:20 split, i.e. 80% of the data under is used for training, and 20% for validation.</p>
<div class="highlight"><pre><span></span><code><span class="nb">len</span><span class="p">(</span><span class="n">dsets</span><span class="o">.</span><span class="n">train</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">dsets</span><span class="o">.</span><span class="n">valid</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>(1340, 334)
</code></pre></div>
<p>After training the model, we can test it with the images under <code>binary/test</code>. The model has never seen the images under <code>binary/test</code> during the training process, and thus this is a good way to test the generalization of the model. Sometimes, when we don't have a lot of data, we only split the data into a train set and a validation set.</p>
<p>It is useful to see how <code>Datasets</code> internally represents the data.</p>
<div class="highlight"><pre><span></span><code><span class="n">dsets</span><span class="o">.</span><span class="n">train</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dsets</span><span class="o">.</span><span class="n">valid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>((PILImage mode=RGB size=1126x1000, TensorCategory(0)),
 (PILImage mode=RGB size=3024x4032, TensorCategory(1)))
</code></pre></div>
<p class="annotate">It records the type of input, colored images, along with their original sizes. But more importantly, it automatically transforms the categories <em>Boletus edulis</em> and <em>Amanita muscaria</em> to 1 and 0, respectively. (1)</p>
<ol>
<li>The <code>vocab</code> attribute of the <code>Datasets</code> object will tell you which category is mapped to which number. Try running <code>dsets.vocab</code>, the list index of a species is the number it has been mapped to.</li>
</ol>
<p class="annotate">We can use <code>dsets</code> to load the data to a model. However, it is best to load the images to a model in small batches (mini-batch). We will create a <code>DataLoaders</code> object which can load the images in small batches (default size is 64). (1)</p>
<ol>
<li>You do not need to create a <code>Datasets</code> object to create a <code>DataLoaders</code> object. <code>dsets</code> was just for demonstrating some of the internals of <code>fastai</code>. Think of <code>DataLoaders</code> as <code>Datasets</code> but with a batch size.</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="n">dls</span> <span class="o">=</span> <span class="n">dblock</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span><span class="n">p</span> <span class="o">/</span> <span class="s2">&quot;binary&quot;</span> <span class="o">/</span> <span class="s2">&quot;train&quot;</span><span class="p">)</span>
<span class="n">dls</span><span class="o">.</span><span class="n">show_batch</span><span class="p">(</span><span class="nb">max</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
</code></pre></div>
<p><img src="images/binary_batch.png" alt="Binay classification batch", width="600"/></p>
<p>Now it is the time to train a model. You can build and train a deep learning model from scratch. An alternative is to fine-tune a pre-trained model. Fine-tuning is essentially taking advantage of past training, usually training done by the community, or some corporate. Instead of starting with a model with random parameters, you now start with a model that knows something. Generally fine-tuning a pre-trained model takes less time and data than training a model from scratch.</p>
<p>For an image classification you should a choose a model that has been trained on some large image dataset. One such model is Resnet-34 from <a href="https://arxiv.org/abs/1512.03385">Deep Residual Learning for Image Recognition</a>, trained on the ImageNet dataset. See <a href="https://www.kaggle.com/code/jhoward/which-image-models-are-best">Which image models are best? </a> for a catalog of such models. <code>fastai</code> provides a <code>vision_learner</code> object for easy training or fine-tuning image models.</p>
<div class="highlight"><pre><span></span><code><span class="n">learn</span> <span class="o">=</span> <span class="n">vision_learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">resnet34</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">error_rate</span><span class="p">)</span>
</code></pre></div>
<p>The <code>lr_find</code> method helps to choose a suitable learning rate. </p>
<div class="highlight"><pre><span></span><code><span class="n">learn</span><span class="o">.</span><span class="n">lr_find</span><span class="p">()</span>
</code></pre></div>
<p><img src="images/lr_find.png" alt="Choosing learning rate", width="600"/></p>
<p class="annotate">Any learning around, preferably larger, the valley (orange point) will be suitable for fine-tuning Resnet-34 to the binary dataset. Fine-tune the model for 3 epochs. (1)</p>
<ol>
<li>A good exercise to change the number of epochs, and see how that affects the model's learning. </li>
</ol>
<div class="highlight"><pre><span></span><code><span class="n">learn</span><span class="o">.</span><span class="n">fine_tune</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mf">2e-3</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>epoch   train_loss  valid_loss  error_rate  time
    0   0.605542    0.055386    0.017964    01:21

epoch   train_loss  valid_loss  error_rate  time
    0   0.139088    0.088573    0.032934    01:21
    1   0.088828    0.051099    0.020958    01:21
    2   0.061853    0.035076    0.008982    01:22
</code></pre></div>
<p>We can use the <code>show_results</code> method of the <code>vision_learner</code> class to get a more visual sense of the quality of the learning. A better method is to use an <code>Interpretation</code> object. With an <code>Interpretation</code> object we can plot a confusion matrix, or print a overall performance report.</p>
<div class="highlight"><pre><span></span><code><span class="n">interp</span> <span class="o">=</span> <span class="n">ClassificationInterpretation</span><span class="o">.</span><span class="n">from_learner</span><span class="p">(</span><span class="n">learn</span><span class="p">)</span> 
<span class="n">interp</span><span class="o">.</span><span class="n">plot_top_losses</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span>
</code></pre></div>
<p><img src="images/binary_interp_top_losses.png" alt="Top losses", width="600"/></p>
<div class="highlight"><pre><span></span><code><span class="n">interp</span><span class="o">.</span><span class="n">plot_confusion_matrix</span><span class="p">()</span>
</code></pre></div>
<p><img src="images/binary_interp_conf_matrix.png" alt="Confusion matrix", width="400"/></p>
<p><div class="highlight"><pre><span></span><code><span class="n">interp</span><span class="o">.</span><span class="n">print_classification_report</span><span class="p">()</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>                  precision    recall  f1-score   support

Amanita muscaria       1.00      0.98      0.99        96
  Boletus edulis       0.98      1.00      0.99        90

        accuracy                           0.99       186
       macro avg       0.99      0.99      0.99       186
    weighted avg       0.99      0.99      0.99       186
</code></pre></div></p>
<p>The confusion matrix and the classification report show how well the trained model performs on the validation set. Both the confusion matrix and the classification report give us the same information, we can explicitly calculate the metrics in the classification report from the confusion matrix. Choose whichever one that conveys the information better.</p>
<p>We can also do the same with the test set (<code>binary/test</code>), which the model didn't see during training.</p>
<div class="highlight"><pre><span></span><code><span class="n">test_files</span> <span class="o">=</span> <span class="n">get_image_files</span><span class="p">(</span><span class="n">p</span> <span class="o">/</span> <span class="s2">&quot;binary&quot;</span> <span class="o">/</span> <span class="s2">&quot;test&quot;</span><span class="p">)</span> 
<span class="n">test_dl</span> <span class="o">=</span> <span class="n">dls</span><span class="o">.</span><span class="n">test_dl</span><span class="p">(</span><span class="n">test_files</span><span class="p">,</span> <span class="n">with_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># (1)!</span>
</code></pre></div>
<ol>
<li>This creates a test dataloader using the same transformations used to create the dataloader for the validation set.</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="n">preds</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">get_preds</span><span class="p">(</span><span class="n">dl</span><span class="o">=</span><span class="n">test_dl</span><span class="p">)</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">preds</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span> 
    <span class="n">prediction</span> <span class="o">=</span> <span class="n">dls</span><span class="o">.</span><span class="n">categorize</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">item</span><span class="p">))</span> 
    <span class="n">confidence</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> 
    <span class="n">percent</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">confidence</span><span class="p">)</span> 
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Prediction: </span><span class="si">{</span><span class="n">prediction</span><span class="si">:</span><span class="s2">18</span><span class="si">}</span><span class="s2"> - Confidence: </span><span class="si">{</span><span class="n">percent</span><span class="si">:</span><span class="s2">.2%</span><span class="si">}</span><span class="s2"> - Image: </span><span class="si">{</span><span class="n">test_dl</span><span class="o">.</span><span class="n">items</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>...
Prediction: Boletus edulis     - Confidence: 100.00% - Image: 2238481466-242195.JPG
Prediction: Boletus edulis     - Confidence: 100.00% - Image: 2864902315-212162.JPG
Prediction: Boletus edulis     - Confidence: 98.13% - Image: 2860312323-62558.JPG
Prediction: Boletus edulis     - Confidence: 99.98% - Image: 2413150418-44022.JPG
Prediction: Boletus edulis     - Confidence: 98.77% - Image: 2860298436-285200.JPG
Prediction: Boletus edulis     - Confidence: 96.30% - Image: 2856920321-284750.JPG
Prediction: Amanita muscaria   - Confidence: 100.00% - Image: 2238561790-182394.JPG
Prediction: Amanita muscaria   - Confidence: 74.62% - Image: 2874318440-215186.JPG
Prediction: Amanita muscaria   - Confidence: 99.99% - Image: 2898623358-68526.JPG
Prediction: Amanita muscaria   - Confidence: 99.81% - Image: 2864909415-212510.JPG
Prediction: Amanita muscaria   - Confidence: 100.00% - Image: 2430667070-196992.JPG
Prediction: Amanita muscaria   - Confidence: 100.00% - Image: 2238525200-175134.JPG
...
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">interp</span> <span class="o">=</span> <span class="n">ClassificationInterpretation</span><span class="o">.</span><span class="n">from_learner</span><span class="p">(</span><span class="n">learn</span><span class="p">,</span> <span class="n">dl</span><span class="o">=</span><span class="n">test_dl</span><span class="p">)</span>
<span class="n">interp</span><span class="o">.</span><span class="n">plot_confusion_matrix</span><span class="p">()</span>
</code></pre></div>
<p><img src="images/binary_interp_conf_matrix_test.png" alt="Confusion matrix for test set", width="400"/></p>
<h4 id="multi-class-classification">Multi-class classification</h4>
<p>The code for the multi-class classification can be exactly the same as for the binary classification. Just for experimentation and demonstration, we will try something little different. Instead of a train/validation/test split, try a train/validation split - all images under <code>train</code> used for training, and all images under <code>test</code> used for validation, with no separate test set. The <code>GrandparentSplitter</code> from <code>fastai</code> is useful for this arrangement.</p>
<div class="highlight"><pre><span></span><code><span class="n">dblock</span> <span class="o">=</span> <span class="n">DataBlock</span><span class="p">(</span><span class="n">blocks</span> <span class="o">=</span> <span class="p">(</span><span class="n">ImageBlock</span><span class="p">,</span> <span class="n">CategoryBlock</span><span class="p">),</span>
                   <span class="n">get_items</span> <span class="o">=</span> <span class="n">get_image_files</span><span class="p">,</span>
                   <span class="n">get_y</span> <span class="o">=</span> <span class="n">parent_label</span><span class="p">,</span>
                   <span class="n">splitter</span> <span class="o">=</span> <span class="n">GrandparentSplitter</span><span class="p">(</span><span class="n">train_name</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">,</span> <span class="n">valid_name</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">),</span>
                   <span class="n">item_tfms</span> <span class="o">=</span> <span class="n">Resize</span><span class="p">(</span><span class="mi">224</span><span class="p">))</span>

<span class="n">dls</span> <span class="o">=</span> <span class="n">dblock</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="n">dls</span><span class="o">.</span><span class="n">show_batch</span><span class="p">()</span>
</code></pre></div>
<p><img src="images/multi_batch.png" alt="Multi-class classification batch", width="600"/></p>
<div class="highlight"><pre><span></span><code><span class="n">learn</span> <span class="o">=</span> <span class="n">vision_learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">resnet34</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">error_rate</span><span class="p">)</span>
<span class="n">learn</span><span class="o">.</span><span class="n">lr_find</span><span class="p">()</span>
</code></pre></div>
<p><img src="images/multi_lr_find.png" alt="Choosing learning rate", width="600"/></p>
<p><div class="highlight"><pre><span></span><code><span class="n">learn</span><span class="o">.</span><span class="n">fine_tune</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mf">2e-3</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>epoch   train_loss  valid_loss  error_rate  time
    0   0.660746    0.330275    0.102310    04:38

epoch   train_loss  valid_loss  error_rate  time
    0   0.239338    0.225458    0.077558    04:31
    1   0.141983    0.287751    0.080858    04:33
    2   0.072769    0.190867    0.049505    04:30
    3   0.029050    0.197074    0.049505    04:28
    4   0.015718    0.200661    0.049505    04:39
</code></pre></div></p>
<p><div class="highlight"><pre><span></span><code><span class="n">interp</span> <span class="o">=</span> <span class="n">ClassificationInterpretation</span><span class="o">.</span><span class="n">from_learner</span><span class="p">(</span><span class="n">learn</span><span class="p">)</span>
<span class="n">interp</span><span class="o">.</span><span class="n">plot_confusion_matrix</span><span class="p">()</span>
</code></pre></div>
<img src="images/multi_interp_conf_matrix.png" alt="Confusion matrix", width="400"/></p>
<h3 id="clustering">Clustering </h3>
<p><center><a class="md-button" href="files/penguins-clustering.ipynb">Click here to download Jupyter notebook</a></center></p>
<p>In this example we will cluster penguins into groups based on their bill features. We will use the <a href="https://allisonhorst.github.io/palmerpenguins/articles/intro.html">Palmer penguins</a> dataset.</p>
<p><img src="images/palmerpenguins.png" width="600"></p>
<p><cite>Artwork by <a href="https://twitter.com/allison_horst">@allison_horst</a></cite></p>
<h4 id="accessing-the-data_1">Accessing the data</h4>
<p>There is a Python package <code>palmerpenguins</code> that provides the data, along with some other goodies. However for the purposes of this example you can simply download the <a href="https://raw.githubusercontent.com/mcnakhaee/palmerpenguins/master/palmerpenguins/data/penguins.csv">penguins.csv</a> from the Github repo of the package.</p>
<h4 id="visualizing-the-data">Visualizing the data</h4>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">colormaps</span>

<span class="n">penguins</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;penguins.csv&quot;</span><span class="p">)</span> <span class="c1"># (1)!</span>
<span class="n">penguins</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div>
<ol>
<li>Replace this with the full path to the <code>penguins.csv</code> file if the file and the notebook are not in the same directory.</li>
</ol>
<div class="highlight"><pre><span></span><code>    species        island   bill_length_mm  bill_depth_mm   flipper_length_mm   body_mass_g     sex     year
0    Adelie     Torgersen             39.1           18.7               181.0        3750.0    male     2007
1    Adelie     Torgersen             39.5           17.4               186.0        3800.0  female     2007
2    Adelie     Torgersen             40.3           18.0               195.0        3250.0  female     2007
3    Adelie     Torgersen              NaN            NaN                 NaN           NaN     NaN     2007
4    Adelie     Torgersen             36.7           19.3               193.0        3450.0  female     2007
</code></pre></div>
<p>The dataset list the species of each penguin, which island in Palmer archipelago and which year they were observed in, and some physical features. Complete data for all penguins are not available, missing values are indicated by <code>NaN</code>.</p>
<p><div class="highlight"><pre><span></span><code><span class="n">penguins</span><span class="p">[</span><span class="s2">&quot;species&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>array([&#39;Adelie&#39;, &#39;Gentoo&#39;, &#39;Chinstrap&#39;], dtype=object)
</code></pre></div></p>
<p>There are three unique species of penguins in the dataset. It might be tempting to think that there are three clusters in the dataset - one for each species. However, that need not be the case. Even if there are three clusters, they might not necessarily overlap with any species. Whether the clusters correspond to species will depend on the variance in intra-species differences and the variance in inter-species differences.</p>
<div class="highlight"><pre><span></span><code><span class="n">pd</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">scatter_matrix</span><span class="p">(</span><span class="n">penguins</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;bill_length_mm&quot;</span><span class="p">,</span> <span class="s2">&quot;bill_depth_mm&quot;</span><span class="p">,</span> <span class="s2">&quot;flipper_length_mm&quot;</span><span class="p">,</span> <span class="s2">&quot;body_mass_g&quot;</span><span class="p">],</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
</code></pre></div>
<p><img src="images/penguins_pairplot.png" alt="Penguins pair plot", width="600"/></p>
<p>The figure above shows that only when we plot <code>bill_length_mm</code> vs <code>bill_depth_mm</code>, or <code>bill_length_mm</code> vs <code>flipper_length_mm</code> we see more than two clusters. This does not mean that there are not more that two clusters. It just means that in <em>two-dimensions</em> these are the only two cases where we see hints of more two clusters.</p>
<h4 id="mean-shift-clustering">Mean shift clustering</h4>
<p><mark class="critic">Clustering is an unsupervised machine learning process</mark>, we do not provide any labels when we train the model. This is unlike the previous case of image classification, where we provided the labels (the species that image belonged to). What this means is that a clustering model will not be able to tell if a particular cluster corresponds to a penguin species (or any other suitable label depending on the problem), but it will show the clusters that are there in the dataset.</p>
<p>In mean shift clustering, candidates for centroids are updated to be the mean of the points within a given region. Each observation belongs to the cluster with the nearest mean. See <a href="https://ieeexplore.ieee.org/document/1000236">Mean shift: a robust approach toward feature space analysis</a> for more information on mean shift clustering.</p>
<p>Here is a naive implementation of mean shift clustering. Mean shift clustering depends on a kernel function, which takes in one hyperparameter called bandwidth. In this implemetation, we use the Gaussian kernel: </p>
<div class="arithmatex">\[
g(x) = \frac{1}{\sigma\sqrt{2\pi}}\exp\left(-\frac{1}{2}\frac{(x - \mu)^2}{\sigma^2}\right).
\]</div>
<p>For the Gaussian kernel, the bandwidth is the same as the standard deviation.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">torch</span>

<span class="k">def</span> <span class="nf">gaussian</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span> <span class="o">/</span> <span class="n">sigma</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
        <span class="n">sigma</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span>
    <span class="p">)</span>

<span class="k">def</span> <span class="nf">meanshift</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">bw</span><span class="p">,</span> <span class="n">bs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">bs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">bs</span> <span class="o">&gt;</span> <span class="n">n</span><span class="p">:</span>
        <span class="n">bs</span> <span class="o">=</span> <span class="n">n</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">epochs</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">bs</span><span class="p">):</span>
            <span class="n">dist</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cdist</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span> <span class="p">:</span> <span class="nb">min</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">bs</span><span class="p">,</span> <span class="n">n</span><span class="p">)],</span> <span class="n">X</span><span class="p">)</span>
            <span class="n">weights</span> <span class="o">=</span> <span class="n">gaussian</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">bw</span><span class="p">)</span>
            <span class="n">X</span><span class="p">[</span><span class="n">i</span> <span class="p">:</span> <span class="nb">min</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">bs</span><span class="p">,</span> <span class="n">n</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span><span class="n">weights</span> <span class="o">@</span> <span class="n">X</span><span class="p">)</span> <span class="o">/</span> <span class="n">weights</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdim</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">X</span>
</code></pre></div>
<p class="annotate">In this workshop we will look at a two-dimensional case, as it is easier to visualize. We will pick two physical features of the penguins, and see if we can identify the clusters in that two-dimensional data. (1)</p>
<ol>
<li>A good exercise will be to try a multidimensional case, by considering more than two physical features of the penguins.</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="n">data</span> <span class="o">=</span> <span class="n">penguins</span><span class="p">[[</span><span class="s2">&quot;bill_length_mm&quot;</span><span class="p">,</span> <span class="s2">&quot;bill_depth_mm&quot;</span><span class="p">]]</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span> <span class="c1"># (1)</span>
</code></pre></div>
<ol>
<li>We need to remove the missing values.</li>
</ol>
<p>Since the mean shift implementation above is with PyTorch, we have to convert the data to PyTorch tensors. This also gives us the opportunity to use GPUs, if available.</p>
<div class="highlight"><pre><span></span><code><span class="n">data</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">():</span> <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">centroids</span> <span class="o">=</span> <span class="n">meanshift</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span> <span class="c1"># (1)!</span>
</code></pre></div>
<ol>
<li>Try a different value, than 1.5, for the bandwidth, and see how that affects the results.</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">penguins</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;bill_length_mm&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;bill_depth_mm&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;bill_length_mm&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;bill_depth_mm&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">centroids</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">centroids</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
</code></pre></div>
<p><img src="images/penguins_mean_shift_centroids.png" alt="Centroids of mean shift clusters", width="600"/></p>
<p>The algorithm gives the centroids for three clusters, but not necessarily in the positions that you would expect them. A good exercise will be to check the scikit-learn implementation of mean shift clustering, and see if the naive implementation above can be improved.</p>









  



  <form class="md-feedback" name="feedback" hidden>
    <fieldset>
      <legend class="md-feedback__title">
        Was this page informative?
      </legend>
      <div class="md-feedback__inner">
        <div class="md-feedback__list">
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page was helpful" data-md-value="1">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M23 10a2 2 0 0 0-2-2h-6.32l.96-4.57c.02-.1.03-.21.03-.32 0-.41-.17-.79-.44-1.06L14.17 1 7.59 7.58C7.22 7.95 7 8.45 7 9v10a2 2 0 0 0 2 2h9c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73v-2M1 21h4V9H1v12Z"/></svg>
            </button>
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page could be improved" data-md-value="0">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 15h4V3h-4m-4 0H6c-.83 0-1.54.5-1.84 1.22l-3.02 7.05c-.09.23-.14.47-.14.73v2a2 2 0 0 0 2 2h6.31l-.95 4.57c-.02.1-.03.2-.03.31 0 .42.17.79.44 1.06L9.83 23l6.58-6.59c.37-.36.59-.86.59-1.41V5a2 2 0 0 0-2-2Z"/></svg>
            </button>
          
        </div>
        <div class="md-feedback__note">
          
            <div data-md-value="1" hidden>
              
              
                
              
              Thanks for your feedback!
            </div>
          
            <div data-md-value="0" hidden>
              
              
                
              
              Thanks for your feedback! Have suggestions for improvements? <a target="_blank" href="https://uarizona.service-now.com/sp?id=sc_cat_item&sys_id=2983102adbd23c109627d90d689619c6&sysparm_category=84d3d1acdbc8f4109627d90d6896191f">Contact us</a>. 
            </div>
          
        </div>
      </div>
    </fieldset>
  </form>


                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
<!--
<div style="padding-right: 40px; padding-bottom:20px; padding-top:10px; text-align: center;">
    <a href="https://uarizona.service-now.com/sp?id=sc_cat_item&sys_id=2983102adbd23c109627d90d689619c6&sysparm_category=84d3d1acdbc8f4109627d90d6896191f" style="font-size: 16px;color:#AB0520; text-decoration: underline; font-weight: bold;" onmouseover="this.style.color='#EF4056'" onmouseout="this.style.color='#AB0520'">Website Feedback</a>
  </div>
-->

<footer class="md-footer">
    <div class="md-footer-meta md-typeset">
        <div class="md-footer-meta__inner md-grid">
            <!-- Copyright and theme information -->
            <div class="md-copyright">
                
                <div class="md-copyright__highlight">
                    University of Arizona Research Computing
                </div>
                

            </div>
            
            <div class="md-social">
  
    
    
    
    
    <a href="https://uarizona.service-now.com/sp?id=sc_cat_item&sys_id=2983102adbd23c109627d90d689619c6&sysparm_category=84d3d1acdbc8f4109627d90d6896191f" target="_blank" rel="noopener" title="Contact HPC consulting" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m20 8-8 5-8-5V6l8 5 8-5m0-2H4c-1.11 0-2 .89-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2Z"/></svg>
    </a>
  
    
    
    
    
    <a href="/support_and_training/faqs/" target="_blank" rel="noopener" title="FAQs" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16 20v2H4c-1.1 0-2-.9-2-2V7h2v13h12m4-18H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2m-5 12h-2v-2h2v2m1.8-5.2c-.3.4-.7.7-1.1.9-.2.2-.4.3-.5.5-.2.2-.2.5-.2.8h-2c0-.5.1-.9.3-1.2.2-.3.5-.6 1-.9.3-.2.5-.4.6-.6.2-.2.2-.5.2-.8 0-.3-.1-.6-.3-.8-.2-.2-.4-.3-.8-.3-.3 0-.5.1-.7.2-.2.2-.3.4-.3.7h-1.9c0-.8.2-1.4.8-1.8.7-.3 1.4-.5 2.3-.5.9 0 1.7.2 2.2.7.5.5.8 1.1.8 1.8 0 .5-.2.9-.4 1.3Z"/></svg>
    </a>
  
    
    
    
    
    <a href="https://portal.hpc.arizona.edu/portal/" target="_blank" rel="noopener" title="User portal" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 4a4 4 0 0 1 4 4 4 4 0 0 1-4 4 4 4 0 0 1-4-4 4 4 0 0 1 4-4m0 10c4.42 0 8 1.79 8 4v2H4v-2c0-2.21 3.58-4 8-4Z"/></svg>
    </a>
  
    
    
    
    
    <a href="https://ood.hpc.arizona.edu/pun/sys/dashboard" target="_blank" rel="noopener" title="Open OnDemand" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.36 14c.08-.66.14-1.32.14-2 0-.68-.06-1.34-.14-2h3.38c.16.64.26 1.31.26 2s-.1 1.36-.26 2m-5.15 5.56c.6-1.11 1.06-2.31 1.38-3.56h2.95a8.03 8.03 0 0 1-4.33 3.56M14.34 14H9.66c-.1-.66-.16-1.32-.16-2 0-.68.06-1.35.16-2h4.68c.09.65.16 1.32.16 2 0 .68-.07 1.34-.16 2M12 19.96c-.83-1.2-1.5-2.53-1.91-3.96h3.82c-.41 1.43-1.08 2.76-1.91 3.96M8 8H5.08A7.923 7.923 0 0 1 9.4 4.44C8.8 5.55 8.35 6.75 8 8m-2.92 8H8c.35 1.25.8 2.45 1.4 3.56A8.008 8.008 0 0 1 5.08 16m-.82-2C4.1 13.36 4 12.69 4 12s.1-1.36.26-2h3.38c-.08.66-.14 1.32-.14 2 0 .68.06 1.34.14 2M12 4.03c.83 1.2 1.5 2.54 1.91 3.97h-3.82c.41-1.43 1.08-2.77 1.91-3.97M18.92 8h-2.95a15.65 15.65 0 0 0-1.38-3.56c1.84.63 3.37 1.9 4.33 3.56M12 2C6.47 2 2 6.5 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10A10 10 0 0 0 12 2Z"/></svg>
    </a>
  
    
    
    
    
    <a href="https://www.youtube.com/@universityofarizonauitsres7597" target="_blank" rel="noopener" title="Training videos" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m10 15 5.19-3L10 9v6m11.56-7.83c.13.47.22 1.1.28 1.9.07.8.1 1.49.1 2.09L22 12c0 2.19-.16 3.8-.44 4.83-.25.9-.83 1.48-1.73 1.73-.47.13-1.33.22-2.65.28-1.3.07-2.49.1-3.59.1L12 19c-4.19 0-6.8-.16-7.83-.44-.9-.25-1.48-.83-1.73-1.73-.13-.47-.22-1.1-.28-1.9-.07-.8-.1-1.49-.1-2.09L2 12c0-2.19.16-3.8.44-4.83.25-.9.83-1.48 1.73-1.73.47-.13 1.33-.22 2.65-.28 1.3-.07 2.49-.1 3.59-.1L12 5c4.19 0 6.8.16 7.83.44.9.25 1.48.83 1.73 1.73Z"/></svg>
    </a>
  
    
    
    
    
    <a href="https://metrics.hpc.arizona.edu/" target="_blank" rel="noopener" title="HPC job metrics" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17.45 15.18 22 7.31V21H2V3h2v12.54L9.5 6 16 9.78l4.24-7.33 1.73 1-5.23 9.05-6.51-3.75L4.31 19h2.26l4.39-7.56 6.49 3.74Z"/></svg>
    </a>
  
</div>
            
        </div>
    </div>
</footer>

    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.tracking", "navigation.instant", "navigation.path", "toc.integrate", "content.tabs.link", "content.tooltips", "content.code.copy", "content.code.annotate", "content.code.select", "navigation.top"], "search": "../../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.ad660dcc.min.js"></script>
      
        <script src="../../../../assets/javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>